{#
 * Collapse Quote
 * An extension for the phpBB Forum Software package.
 *
 * @copyright (c) 2022, Thorsten Ahlers
 * @license GNU General Public License, version 2 (GPL-2.0)
 *
 #}

{% if COLLAPSEQUOTE_TITLE is defined %}
	{% if not definition.INCLUDED_COLPICKJS %}
		{% INCLUDEJS '@imcger_collapsequote/colpick/colpick.js' %}
		{% INCLUDECSS '@imcger_collapsequote/colpick/colpick.css' %}
		{% DEFINE INCLUDED_COLPICKJS = true %}
	{% endif %}

<script>
	/**
	 * Function borrowed from Board Announcements extension for phpBB
	 *
	 * @copyright (c) 2014 phpBB Limited <https://www.phpbb.com>
	 * @license GNU General Public License, version 2 (GPL-2.0)
	 */
	jQuery(function($) {

		$('#imcger_collapsequote_button_bg').colpick({
			layout: 'hex',
			submit: 0,
			onBeforeShow: function() {
				let colour = '{{ COLLAPSEQUOTE_BUTTON_BG|raw }}';
				if (colour !== '') {
					$(this).colpickSetColor(colour);
					colour = '';
				}
			},
			onChange: function(hsb, hex, rgb, el, bySetColor) {
				$(el).css({
					'border-right-color': '#' + hex,
					'border-right-width': '20px',
					'border-right-type': 'solid'
				});
				if (!bySetColor) {
					$(el).val(hex);
				}
			}
		}).keyup(function() {
			$(this).colpickSetColor(this.value || 'ffffff');
		});

		$('#imcger_collapsequote_button_fg').colpick({
			layout: 'hex',
			submit: 0,
			onBeforeShow: function() {
				let colour = '{{ COLLAPSEQUOTE_BUTTON_FG|raw }}';
				if (colour !== '') {
					$(this).colpickSetColor(colour);
					colour = '';
				}
			},
			onChange: function(hsb, hex, rgb, el, bySetColor) {
				$(el).css({
					'border-right-color': '#' + hex,
					'border-right-width': '20px',
					'border-right-type': 'solid'
				});
				if (!bySetColor) {
					$(el).val(hex);
				}
			}
		}).keyup(function() {
			$(this).colpickSetColor(this.value || 'ffffff');
		});

		$('#imcger_collapsequote_button_bg_hover').colpick({
			layout: 'hex',
			submit: 0,
			onBeforeShow: function() {
				let colour = '{{ COLLAPSEQUOTE_BUTTON_BG_HOVER|raw }}';
				if (colour !== '') {
					$(this).colpickSetColor(colour);
					colour = '';
				}
			},
			onChange: function(hsb, hex, rgb, el, bySetColor) {
				$(el).css({
					'border-right-color': '#' + hex,
					'border-right-width': '20px',
					'border-right-type': 'solid'
				});
				if (!bySetColor) {
					$(el).val(hex);
				}
			}
		}).keyup(function() {
			$(this).colpickSetColor(this.value || 'ffffff');
		});

		$('#imcger_collapsequote_button_fg_hover').colpick({
			layout: 'hex',
			submit: 0,
			onBeforeShow: function() {
				let colour = '{{ COLLAPSEQUOTE_BUTTON_FG_HOVER|raw }}';
				if (colour !== '') {
					$(this).colpickSetColor(colour);
					colour = '';
				}
			},
			onChange: function(hsb, hex, rgb, el, bySetColor) {
				$(el).css({
					'border-right-color': '#' + hex,
					'border-right-width': '20px',
					'border-right-type': 'solid'
				});
				if (!bySetColor) {
					$(el).val(hex);
				}
			}
		}).keyup(function() {
			$(this).colpickSetColor(this.value || 'ffffff');
		});
	});
</script>
{% endif %}
